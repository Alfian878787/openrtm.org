// Title: Windowsへのインストール
#contents

** OpenRTM-aistのインストール
msiインストーラーによるOpenRTM-aistのインストール手順については下記のページに記載。

- [[OpenRTM-aist 1.2系のインストール(Windows、msiインストーラー使用):/ja/node/6652]]

*** JDK のインストール
OpenRTM-aist-Java-1.２.ｘの動作にはJDK8相当のもの(JDK11では正常動作しません)が前もってインストールされている必要があります。JDK8相当のJDKとしては、OpenJDKをベースとしたものを用意しているベンダーがいくつかあります。各自、ライセン条件やサポート条件を考慮して選択してください。ここでは、GitHub上でメインテナンスされているOpenJDK8を使うこととして説明をします。

[[OpenJDK8の入手先:https://github.com/ojdkbuild/ojdkbuild/releases]]

より、.msiファイルをダウンロードしてください。ファイル名は64ビット版ならx86_64.msiで32bit版なら64.msiで終端された名前となります。ダウンロードした後は、拡張子.msiのファイルをダブルクリックすればインストールプログラムが起動されます。
#br
**** JDK のインストール確認
コマンド プロンプトを実行し、

 C:\>java -version
と入力します。インストールした Java のバージョンが表示されればインストールは完了です。例えば以下のように表示されます。
 openjdk version "1.8.0_232"
 OpenJDK Runtime Environment (build 1.8.0_232-b09)
 OpenJDK 64-Bit Server VM (build 25.232-b09, mixed mode)

#br

//#ref(java-version.png,60%,center)
//CENTER:''インストールの確認(Windows)''
//#br


&br;
** インストーラーの作業内容
インストーラーは以下の作業を行います。

-インストールディレクトリー (デフォルトは C:\Program Files) 以下に各種ファイルをコピー
-スタートメニュー以下に OpenRTM-aist フォルダーを作成し各種ショートカットを設定
-環境変数の設定
--64bit版msiファイルの場合
 RTM_BASE=C:\Program Files\OpenRTM-aist\\

 RTM_IDL_DIR=C:\Program Files\OpenrRTM-aist\1.2.x\rtm\idl\\

 RTM_JAVA_ROOT=C:\Program Files\OpenRTM-aist\1.2.x\\

 RTM_ROOT=C:\Program Files\OpenRTM-aist\1.２.ｘ\\

 RTM_VC_VERSION=vc14
 OMNI_ROOT=C:\Program Files\OpenRTM-aist\1.2.x\omniORB\4.2.1_%RTM_VC_VERSION%\\

 OpenCV_DIR=C:\Program Files\OpenRTM-aist\1.2.x\OpenCV3.4\\

 OpenRTM_DIR=C:\Program Files\OpenRTM-aist\1.2.x\cmake\\

--32bit用msi利用時の設定
 RTM_BASE=C:\Program Files (x86)\OpenRTM-aist\\

 RTM_IDL_DIR=C:\Program Files (x86)\OpenrRTM-aist\1.2.x\rtm\idl\\

 RTM_JAVA_ROOT=C:\Program Files (x86)\OpenRTM-aist\1.2.x\\

 RTM_ROOT=C:\Program Files (x86)\OpenRTM-aist\1.２.ｘ\\

 RTM_VC_VERSION=vc14
 OMNI_ROOT=C:\Program Files\OpenRTM-aist\1.2.x\omniORB\4.2.3_%RTM_VC_VERSION%\\

 OpenCV_DIR=C:\Program Files\OpenRTM-aist\1.2.x\OpenCV3.4\\

 OpenRTM_DIR=C:\Program FilessOpenRTM-aist\1.2.x\cmake\\

-PATH への追加設定
-- 64bit版msiファイルの場合
 C:\Program Files\OpenRTM-aist\12.x\bin\vc12\\

 C:\Program Files\OpenRTM-aist\1.2.x\omniORB\4.2.1_vc14\bin\x86_win32\\

 C:\Program Files\OpenRTM-aist\1.2.x\OpenCV3.4\x64\vc14\bin\\

--32bit用msi利用時の設定
 C:\Program Files (x86)\OpenRTM-aist\12.x\bin\vc12\\

 C:\Program Files (x86)\OpenRTM-aist\1.2.x\omniORB\4.2.1_vc14\bin\x86_win32\\

 C:\Program Files (x86)\OpenRTM-aist\1.2.x\OpenCV3.4\x86\vc14\bin\\

** インストールされるファイル
ファイルは以下のような構造でインストールされます。&br;
上記のインストール環境の設定を確認する[[スクリプト:/ja/node/6092]]を実行すると、tree コマンドによる OpenRTM-aist ディレクトリー構造をログファイルに保存しますので、詳細を確認することができます。

 <install_dir>
   + OpenRTM-aist
      + 1.x.x  :旧バージョンのランタイム
      + 1.2.1
         + bin: dll、lib各種コマンド
         + cmake: OpenRTMConfig.cmake
         + coil: coilヘッダファイル
         + Components
            + C++
               + Examples: C++サンプルコンポーネント
               + OpenCV: OpenCVのC++サンプルコンポーネント
            + Java: Java サンプルコンポーネント
            + Python: Python サンプルコンポーネント
         + etc: rtc.confサンプル
         + ext: ComponentObserverConsumer
         + jar: jarファイル
         + jre: OpenJDK JRE
         + omniORB
         + OpenCV3.4
         + rtm: OpenRTM-aistヘッダファイル
            + ext: 拡張モジュール用ファイル 
            + idl: OpenRTM-aistIDLファイル
         + util
            + ExcelControlpy: PythonベースのMicrosoft Office用RTC
            + OpenRTP: RTCBuilderとRTSystemEditorツール
            + PowerPointControlpy: Microsoft Office PowerPoint用RTC
            + python_dist: pythonベースツール共通ライブラリ
            + RTCDT: PythonベースRTCの開発を支援するツール
            + rtc-template: RTCBuilderと似た機能を提供する古いツール
            + RTSystemEditor: RTSystem Editorのみのファイル
            + VCVerChanger: 使用しているVisual Studioのバージョンを指定するツール
            + WordContrlpy: PythonベースMicrosoft Office Word用RTC
