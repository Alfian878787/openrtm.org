// Title: OpenRTPの起動手順(1.2系、Windows)
#contents

** OpenRTPの起動
RTCの操作、RTシステムの構築を行うためのツールRT System Editorを起動します。
RT System EditorはOpenRTPというツールの中に含まれているため、まずはOpenRTPを起動する必要があります。
デスクトップのショートカットをダブルクリックするか、Windows 10の場合は左下の「ここに入力して検索」にOpenRTPと入力して検索結果のOpenRTPから起動してください。

#ref(rtm1.png,/ja/node/6614,60%,center)
CENTER:''デスクトップのショートカット''


#ref(rtm2.png,/ja/node/6614,60%,center)
CENTER:''ここに入力して検索''

*** RT System Editor (RTSE) の起動

OpenRTPの「パースペクティブを開く」ボタンをクリックしてください。

#ref(rtm3.png,/ja/node/6614,60%,center)
CENTER:''パースペクティブを開くをクリック''

パースペクティブを開くウィンドウから''RT System Editor''を選択して開くボタンをクリックしてください。

#ref(rtm4.png,/ja/node/6614,60%,center)
CENTER:''RT System Editorの起動''

** ネームサーバーの起動
まず、コンポーネントの参照を登録するためのネームサーバーを起動します。

#ref(rtm5.png,/ja/node/6614,60%,center)
CENTER:''ネームサーバーの起動''

ネームサーバーの起動に成功するとネームサービスビューに''localhost''と表示されます。

#ref(rtm6.png,/ja/node/6614,60%,center)
CENTER:''ネームサーバーの起動を確認''

*** ネームサーバーが起動しない場合

**** omniORB がインストールされていない。

openrtm.org が提供する msi インストーラーには omniORB が含まれていますが、手動でインストールした場合には、omniORB が入っていない場合も考えられますので、omniORB がインストールされているか確認してください。


**** 環境変数 OMNI_ROOT が設定されていない

「Start Naming Service」は %RTM_ROOT%\bin\rtm-naming.bat にあるバッチファイルからネームサーバー (omniNames.exe) を起動します。
この際、omniNames.exe を参照するために環境変数 OMNI_NAMES を利用しています。
通常インストーラーで OpenRTM-aist をインストールした場合には、OMNI_ROOT 環境変数が自動で設定されますが、何らかの理由で環境変数が無効になっていたり、手動でインストールした場合などは、環境変数が設定されていないことがあります。

環境変数 OMNI_ROOT が設定されていることを確認してください。
環境変数は、
-[コントロールパネル] > [システム] > [詳細設定]タブ > [環境変数]
-[マイコンピューター] を右クリック、[プロパティ] を選択、[詳細設定] タブ > [環境変数] などから参照・編集することができます。

*** その他

ユーザー名が2バイト文字の場合、ログを出力するフォルダーを適切に設定できずに omniNames.exe の起動に失敗する場合があります。
その場合、環境変数 TEMP を2バイト文字を含まない場所に設定することで改善する場合があります。
適当なテンポラリディレクトリー (以下のケースでは C:\temp) を作成し、そこを環境変数 TEMP が指すように設定してネームサーバーを起動します。

 set TEMP=C:\temp
 cmd /c rtm-naming.bat



また、稀なケースですが、ホスト名やアドレスの設定の問題で、起動がうまくいかないケースがあります。
その場合、利用している PC の IPアドレス を omniNames.exe に教えてあげるとうまくいくケースがります。
環境変数 OMNIORB_USEHOSTNAME を以下のように設定します (以下は自ホストの IPアドレスが 192.168.0.11 の場合の例)。

 set cosnames="omninames"
 set orb="omniORB"
 set port=%1
 set OMNIORB_USEHOSTNAME=192.168.0.11
 set PATH=%PATH%;%OMNI_ROOT%\bin\x86_win32
